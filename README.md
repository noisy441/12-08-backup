# Домашнее задание к занятию «Резервное копирование баз данных» - Дудин Сергей Васильевич

**Домашнее задание выполните в Google Docs или в md-файле в вашем репозитории GitHub.** 

Для оформления вашего решения в GitHub можете воспользоваться [шаблоном](https://github.com/netology-code/sys-pattern-homework).

Название файла должно содержать номер лекции и фамилию студента. Пример названия: «12.8. Резервное копирование баз данных — Александр Александров».

Перед тем как выслать ссылку, убедитесь, что её содержимое не является приватным, то есть открыто на просмотр всем, у кого есть ссылка. Если необходимо прикрепить дополнительные ссылки, просто добавьте их в свой Google Docs.

Любые вопросы по решению задач задавайте в чате учебной группы.

---

### Задание 1. Резервное копирование

### Кейс
Финансовая компания решила увеличить надёжность работы баз данных и их резервного копирования. 

Необходимо описать, какие варианты резервного копирования подходят в случаях: 

1.1. Необходимо восстанавливать данные в полном объёме за предыдущий день.

1.2. Необходимо восстанавливать данные за час до предполагаемой поломки.

1.3.* Возможен ли кейс, когда при поломке базы происходило моментальное переключение на работающую или починенную базу данных.

*Приведите ответ в свободной форме.*

---

### Решение 1.

1.1 Нужно восстановить данные полностью за предыдущий день. Для этой цели подойдет ежедневный полный (горячий) или еженедельный полный + ежедневный дифференциальный бекап. При таком подходе, мы например, ночью в одно и то же время делаем полный бекап и храним их неколько дней, в зависимости от того, как мы решили в оргпнизации. В идеале храмин в разнвх местах, чтобы минимизировать риски связанные с провайдером услуг. Мы легко сможем восстановить копию базы на любую дату из тех, которые хранятся у нас в хранилище бекапов, но при этом копии занимают дисковое пространство.

1.2 Нужно восстановить данные за час до предполагаемой поломки. Будем делать ежедневный полный (горячий) бекап и непрерывно архивировать журнал транзакций (transaction log). Если нам понадобится восстановить состояние базы за час до прежполагаемой поломки, мы восстанавливаем основной бекам за предыдущие сути и поверх накатываем транзакции до необходимого времени.
*В качестве альтернативы можно рассмотреть возможность почасового снятия snapshot’ов томов/дисков*

1.3 Да, это возможно, но это уже не будет бекап, а скорее отказоустойчивый кластер СУДБ. Для этого БД должна быть размещена у провйдера облачных услуг (например Яндекс cloud). При таком подходе, у нас присутствует Primary + синхронная (или ассинхронная) реплика (RPO ≈ 0) и автоматический failover. В зависимости от того, синхронная или ассинхронная реплика используется будет отличаться RPO. В случае с ассинхронной перликой он может достигать десятков секунд. 
При возникновении проблем или поломки базы, failover автоматически моментально переключит запросы на работающую БД, а в случае возвращения в строй починенной баззы, плановый switchover/role change позволит переключить запросы обратно, либо вручную либо по расписанию. 

---

### Задание 2. PostgreSQL

2.1. С помощью официальной документации приведите пример команды резервирования данных и восстановления БД (pgdump/pgrestore).

2.1.* Возможно ли автоматизировать этот процесс? Если да, то как?

*Приведите ответ в свободной форме.*

---

### Решение 2.


---

### Задание 3. MySQL

3.1. С помощью официальной документации приведите пример команды инкрементного резервного копирования базы данных MySQL. 

3.1.* В каких случаях использование реплики будет давать преимущество по сравнению с обычным резервным копированием?

*Приведите ответ в свободной форме.*

---

### Решение 3.


---

Задания, помеченные звёздочкой, — дополнительные, то есть не обязательные к выполнению, и никак не повлияют на получение вами зачёта по этому домашнему заданию. Вы можете их выполнить, если хотите глубже шире разобраться в материале.
